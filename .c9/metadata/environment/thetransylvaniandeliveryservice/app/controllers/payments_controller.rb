{"filter":false,"title":"payments_controller.rb","tooltip":"/thetransylvaniandeliveryservice/app/controllers/payments_controller.rb","undoManager":{"mark":14,"position":14,"stack":[[{"start":{"row":0,"column":0},"end":{"row":15,"column":7},"action":"remove","lines":["class PaymentsController < ApplicationController","def create","  token = params[:stripeToken]","    @product = Product.find(params[:product_id])","    @user = current_user","    ","    charge = Stripe::Charge.create(","      amount: 2000, # amount in cents, again","      currency: \"usd\",","      source: token,","      description: params[:stripeEmail]","    )","    ","    if charge.paid","     Order.create()","    end"],"id":2},{"start":{"row":0,"column":0},"end":{"row":36,"column":9},"action":"insert","lines":["class PaymentsController < ApplicationController","","def create","    @product = Product.find(params[:product_id])","    @user = current_user","","    token = params[:stripeToken]","","    begin","","      # Amount in cents","      @amount = (@product.price * 100).to_i,","","      # customer = Stripe::Customer.create(","      #   :email => params[:stripeEmail],","      #   :source  => params[:stripeToken]","      # )","","      charge = Stripe::Charge.create(","        # customer: customer.id,","        amount: (@product.price * 100).to_i,","        currency: \"usd\",","        source: token,","        description: \"Magical Unicorn Dust '\"+@product.name+\"'\",","        metadata: {","          'Email-address:' => params[:stripeEmail]","        },","        receipt_email: params[:stripeEmail]","      )","","      if charge.paid","        Order.create(","          product_id: @product.id,","          total: @product.price","        )","        flash[:success] = \"Your payment was processed successfully\"","      end"]}],[{"start":{"row":47,"column":0},"end":{"row":47,"column":1},"action":"insert","lines":["e"],"id":3},{"start":{"row":47,"column":1},"end":{"row":47,"column":2},"action":"insert","lines":["n"]},{"start":{"row":47,"column":2},"end":{"row":47,"column":3},"action":"insert","lines":["d"]}],[{"start":{"row":43,"column":0},"end":{"row":43,"column":2},"action":"insert","lines":["  "],"id":4}],[{"start":{"row":43,"column":0},"end":{"row":43,"column":2},"action":"remove","lines":["  "],"id":5},{"start":{"row":42,"column":97},"end":{"row":43,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":42,"column":97},"end":{"row":43,"column":0},"action":"insert","lines":["",""],"id":6},{"start":{"row":43,"column":0},"end":{"row":43,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":45,"column":0},"end":{"row":45,"column":2},"action":"remove","lines":["  "],"id":7},{"start":{"row":44,"column":2},"end":{"row":45,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":44,"column":2},"end":{"row":45,"column":0},"action":"insert","lines":["",""],"id":8},{"start":{"row":45,"column":0},"end":{"row":45,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":46,"column":0},"end":{"row":46,"column":2},"action":"insert","lines":["  "],"id":9}],[{"start":{"row":46,"column":0},"end":{"row":46,"column":2},"action":"remove","lines":["  "],"id":10}],[{"start":{"row":47,"column":0},"end":{"row":47,"column":2},"action":"insert","lines":["  "],"id":11}],[{"start":{"row":47,"column":0},"end":{"row":47,"column":2},"action":"remove","lines":["  "],"id":12}],[{"start":{"row":43,"column":2},"end":{"row":43,"column":4},"action":"remove","lines":["  "],"id":13}],[{"start":{"row":43,"column":2},"end":{"row":43,"column":4},"action":"insert","lines":["  "],"id":14}],[{"start":{"row":47,"column":3},"end":{"row":48,"column":0},"action":"insert","lines":["",""],"id":15},{"start":{"row":48,"column":0},"end":{"row":49,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":48,"column":0},"end":{"row":49,"column":0},"action":"remove","lines":["",""],"id":16},{"start":{"row":47,"column":3},"end":{"row":48,"column":0},"action":"remove","lines":["",""]}]]},"ace":{"folds":[],"scrolltop":117,"scrollleft":0,"selection":{"start":{"row":47,"column":3},"end":{"row":47,"column":3},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":7,"state":"start","mode":"ace/mode/ruby"}},"hash":"adde0ae6db8324213d75c2d6a750e92914fbd771","timestamp":1536740957489}